import{a as tt,b as et,c as ot}from"./chunk-X2XSU66I.js";import{c as nt,e as it,g as at,h as rt,i as h,j as st,k as E}from"./chunk-JT3BTNV4.js";import{$ as B,A as p,B as s,C as a,D as b,E as R,F as C,G as F,H as d,I as w,J as _,K as y,L as I,M as N,O as A,P as D,Q as j,V as L,W,_ as V,a as T,aa as z,ea as q,fa as H,ga as K,ha as G,i as M,ia as J,ja as Q,k as P,ka as U,la as X,na as Y,oa as Z,p as k,pa as $,q as x,v as l,x as f,y as O,z as g}from"./chunk-OVW572WK.js";import"./chunk-Y2PDZ72K.js";import"./chunk-Z6NEOT2M.js";import"./chunk-MSMJJC2X.js";import"./chunk-53OGNGEH.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-REYR55MP.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as S,e as m}from"./chunk-JHI3MBHO.js";var ct=(()=>{let n=class n{constructor(e){this.database=e,this.dbPath="contatos",this.initializeContactsNode()}initializeContactsNode(){return m(this,null,function*(){let e=h(this.database,this.dbPath);(yield it(e)).exists()||(yield E(e,{}))})}addContato(e){return m(this,null,function*(){try{let t=h(this.database,this.dbPath),o={nome:e.nome||"",email:e.email||"",createdAt:new Date().toISOString()},c=rt(t);return yield E(c,o),{success:!0,id:c.key}}catch(t){throw console.error("Erro ao adicionar contato:",t),t}})}getContatos(){let e=h(this.database,this.dbPath);return new T(t=>{let o=at(e,c=>{try{let i=c.val(),lt=i?Object.keys(i).map(v=>S({id:v},i[v])):[];t.next(lt)}catch(i){t.error(i)}},c=>{console.error("Erro ao buscar contatos:",c),t.error(c)});return()=>o()})}deleteContato(e){return m(this,null,function*(){try{let t=h(this.database,`${this.dbPath}/${e}`);return yield st(t),{success:!0}}catch(t){throw console.error("Erro ao deletar contato:",t),t}})}};n.\u0275fac=function(t){return new(t||n)(P(nt))},n.\u0275prov=M({token:n,factory:n.\u0275fac,providedIn:"root"});let r=n;return r})();var pt=()=>["/home"];function ut(r,n){r&1&&(s(0,"p"),d(1,"Nenhum contato salvo ainda."),a())}function ht(r,n){if(r&1){let u=R();s(0,"ion-item")(1,"ion-label")(2,"h3"),d(3),a(),s(4,"p"),d(5),a()(),s(6,"ion-button",10),C("click",function(){let t=k(u).$implicit,o=F();return x(o.deletarContato(t.id))}),b(7,"ion-icon",11),a()()}if(r&2){let u=n.$implicit;l(3),w(u.nome||u.name),l(2),w(u.email||"-")}}var kt=(()=>{let n=class n{constructor(e,t,o){this.firebaseService=e,this.router=t,this.toastController=o,this.contato={nome:"",email:""},this.contatos=[]}ngOnInit(){tt({arrowBackOutline:et,trashOutline:ot})}deletarContato(e){return m(this,null,function*(){try{yield this.firebaseService.deleteContato(e),yield this.presentToast("Contato exclu\xEDdo com sucesso!")}catch(t){console.error("Erro ao excluir contato:",t),yield this.presentToast("Erro ao excluir contato","danger")}})}ngAfterViewInit(){this.subscribeContatos()}ngOnDestroy(){this.contatosSub?.unsubscribe()}presentToast(e,t="success"){return m(this,null,function*(){(yield this.toastController.create({message:e,duration:2e3,color:t,position:"bottom"})).present()})}adicionarContato(){return m(this,null,function*(){if(!this.contato.nome||!this.contato.email){yield this.presentToast("Por favor, preencha todos os campos","warning");return}try{if((yield this.firebaseService.addContato(this.contato)).success)yield this.presentToast("Contato adicionado com sucesso!"),this.contato={nome:"",email:""};else throw new Error("Falha ao adicionar contato")}catch(e){console.error("Erro ao adicionar contato:",e);let t="Erro ao adicionar contato. ";if(e.code)switch(e.code){case"PERMISSION_DENIED":t+="Sem permiss\xE3o para adicionar.";break;case"NETWORK_ERROR":t+="Verifique sua conex\xE3o.";break;default:t+="Tente novamente mais tarde."}yield this.presentToast(t,"danger")}})}subscribeContatos(){this.contatosSub=this.firebaseService.getContatos().subscribe({next:e=>{this.contatos=e||[]},error:e=>console.error("Erro ao buscar contatos do Firebase:",e)})}};n.\u0275fac=function(t){return new(t||n)(f(ct),f(L),f(Y))},n.\u0275cmp=O({type:n,selectors:[["app-adicionar-contato"]],decls:23,vars:8,consts:[[3,"translucent"],[1,"ion-padding",3,"fullscreen"],["label","Nome","labelPlacement","floating","placeholder","Digite o nome",3,"ngModelChange","ngModel"],["label","Email","labelPlacement","floating","placeholder","Digite o email","type","email",3,"ngModelChange","ngModel"],[1,"ion-padding"],["expand","block",3,"click"],[4,"ngIf"],[4,"ngFor","ngForOf"],["shape","round",1,"ion-padding",3,"routerLink"],["slot","icon-only","name","arrow-back-outline"],["slot","end","color","danger",3,"click"],["name","trash-outline"]],template:function(t,o){t&1&&(s(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),d(3,"Adicionar Contato"),a()()(),s(4,"ion-content",1)(5,"ion-list")(6,"ion-item")(7,"ion-input",2),I("ngModelChange",function(i){return y(o.contato.nome,i)||(o.contato.nome=i),i}),a()(),s(8,"ion-item")(9,"ion-input",3),I("ngModelChange",function(i){return y(o.contato.email,i)||(o.contato.email=i),i}),a()()(),s(10,"div",4)(11,"ion-button",5),C("click",function(){return o.adicionarContato()}),d(12," Adicionar Contato "),a()(),s(13,"ion-list")(14,"ion-item")(15,"ion-label")(16,"h2"),d(17,"Contatos salvos"),a(),g(18,ut,2,0,"p",6),a()(),g(19,ht,8,2,"ion-item",7),a(),s(20,"div")(21,"ion-button",8),b(22,"ion-icon",9),a()()()),t&2&&(p("translucent",!0),l(4),p("fullscreen",!0),l(3),_("ngModel",o.contato.nome),l(2),_("ngModel",o.contato.email),l(9),p("ngIf",o.contatos.length===0),l(),p("ngForOf",o.contatos),l(2),p("routerLink",N(7,pt)))},dependencies:[H,K,U,X,j,A,D,z,V,B,q,Z,W,$,Q,G,J],encapsulation:2});let r=n;return r})();export{kt as AdicionarContatoPage};
